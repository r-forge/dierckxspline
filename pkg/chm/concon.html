<html><head><title>Curve fitting with splines</title>
<meta http-equiv="Content-Type" content="text/html; charset=">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>concon(DierckxSpline)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   concon">
<param name="keyword" value="R:   concon.default">
<param name="keyword" value=" Curve fitting with splines">
</object>


<h2>Curve fitting with splines</h2>


<h3>Description</h3>

<p>
General curve fitting with splines with convexity constraints. Wrapper for function CONCON.
</p>


<h3>Usage</h3>

<pre>
concon(x, ...)
## Default S3 method:
concon(x, y = NULL, w = NULL, v = 0, s = 0, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
A <code>data.frame</code>, <code>matrix</code>, or <code>numeric</code>
vector. See details.</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
Optional numeric vector. See details.</td></tr>
<tr valign="top"><td><code>w</code></td>
<td>
Optional vector of weights</td></tr>
<tr valign="top"><td><code>v</code></td>
<td>
Convexity constraints. See details.</td></tr>
<tr valign="top"><td><code>s</code></td>
<td>
Smoothing parameter</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Additional arguments used only in
<code>update.concon</code>. Otherwise, ignored.</td></tr>
</table>

<h3>Details</h3>

<p>
As with <code><a onclick="findlink('stats', 'smooth.spline.html')" style="text-decoration: underline; color: blue; cursor: hand">smooth.spline</a></code>, the <code>x</code> vector should
contain at least four distinct values. <EM>Distinct</EM> here means
``distinct after rounding to 6 significant digits'', i.e., <code>x</code>
will be transformed to <code>unique(sort(signif(x, 6)))</code>, and
<code>y</code>, <code>w</code>, and <code>v</code> are pooled accordingly.
</p>
<p>
For the default method, arguments <code>x</code> and <code>y</code> are supplied
to <code><a onclick="findlink('grDevices', 'xy.coords.html')" style="text-decoration: underline; color: blue; cursor: hand">xy.coords</a></code> to determine abscissa and ordinate
values. The actual function used is <code>DierckxSpline:::xyw.coords</code>
which is not exported in the <code>NAMESPACE</code>.
</p>
<p>
<code>concon</code> determines a smooth cubic spline approximation
<code>s(x)</code>. See chapters 1 and 3 in the reference for definition of
symbols.
</p>
<p>
The vector <code>v</code> should be the same length as <code>x</code>. <code>v[i]</code>
must be set to <code>1</code> if <code>s(x)</code> must be locally concave at <code>x[i]</code>,
to <code>-1</code> if <code>s(x)</code> must be locally convex at <code>x[i]</code> and to <code>0</code>
if no convexity constraint is imposed at <code>x[i]</code>. If all <code>v</code>
are 0 (no consraints) an error is thrown suggesting the use of
<code><a href="curfit.html">curfit</a></code> instead.
</p>


<h3>Author(s)</h3>

<p>
Sundar Dorai-Raj
</p>


<h3>References</h3>

<p>
Dierckx, P. (1991) <EM>Curve and Surface Fitting with Splines</EM>, Oxford
Science Publications.
</p>


<h3>See Also</h3>

<p>
<code><a href="curfit.html">curfit</a></code>, <code><a onclick="findlink('stats', 'spline.html')" style="text-decoration: underline; color: blue; cursor: hand">spline</a></code>, <code><a onclick="findlink('stats', 'smooth.spline.html')" style="text-decoration: underline; color: blue; cursor: hand">smooth.spline</a></code>
</p>


<h3>Examples</h3>

<pre>
data(moisture)
f1 &lt;- with(moisture, concon(x, y, w, v, s = 0.2))
f2 &lt;- update(f1, s = 0.04)
f3 &lt;- update(f1, s = 0.0002)
g1 &lt;- with(moisture, curfit(x, y, w, method = "ls", knots = knots(f1)))
g2 &lt;- update(g1, knots = knots(f2))
g3 &lt;- update(g1, knots = knots(f3))

newx &lt;- with(moisture, seq(min(x), max(x), length = 100))
method &lt;- c("Convexity Constrained", "Unconstrained Least Squares")
group &lt;- c("0 interior knots", "1 interior knot", "3 interior knots")
out &lt;- data.frame(x = rep(newx, times = 6),
                  y = c(predict(f1, newx),
                    predict(f2, newx),
                    predict(f3, newx),
                    predict(g1, newx),
                    predict(g2, newx),
                    predict(g3, newx)),
                  group = rep(group, each = 100, times = 2),
                  method = rep(method, each = 3 * 100))

library(lattice)
xyplot(y ~ x | method, out, groups = group,
       panel = function(...) {
         panel.superpose(...)
         panel.xyplot(moisture$x, moisture$y,
                      col = "#800000", pch = 16, cex = 1.2)
       },
       xlim = c(-1, 11), xlab = "", ylab = "",
       layout = c(1, 2), as.table = TRUE,
       scales = list(cex = 1.2),
       par.strip.text = list(cex = 1.5),
       type = "l", lwd = 3,
       key = list(space = "top", cex = 1.2, columns = 3,
         text = list(levels(out$group)),
         lines = list(lwd = 3, col = trellis.par.get("superpose.line")$col[1:3])))
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>DierckxSpline</em> version 1.0-2 <a href="00Index.html">Index]</a></div>

</body></html>
